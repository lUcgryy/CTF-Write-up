Java.perform(function() {
    const Activity = Java.use("com.stego.saw.MainActivity");
    Activity.onCreate.implementation = function(savedInstanceState) {
        console.log("Hooking onCreate");
        var intent = this.getIntent();
        intent.putExtra("open", "sesame");
        var extras = intent.getExtras();
        console.log("Extras: " + extras);
        console.log("Intent: " + intent);
        this.onCreate(savedInstanceState);
        // this.finish();
    };
    Interceptor.attach(Module.findExportByName("libdefault.so", "_Z17_Z1aP7_JNIEnvP8_1PKcS0_"), {
        onEnter: function(args) {
            console.warn("Hooking _Z17_Z1aP7_JNIEnvP8_1PKcS0_");
            console.log("arg1: " + args[0].readUtf8String());
            console.log("arg2: " + args[1].readUtf8String());
        },
        onLeave: function(retval) {
            console.log("Return Value: " + retval);
        }
    });
}, 0);